<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8"/>
    <title>1. 導入</title>
    <link rel="stylesheet" href="../tufte.css"/>
    <link rel="stylesheet" href="../latex.css"/>
    <link rel="stylesheet" href="../umatani.css"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- 綺麗なアイコン -->
    <link href="https://use.fontawesome.com/releases/v5.6.1/css/all.css"
          rel="stylesheet"/>
    <!-- <\!-- Highlight.js -\-> -->
    <!-- <link rel="stylesheet" href="highlight/styles/default.css"/> -->
    <!-- <script src="highlight/highlight.pack.js"></script> -->
    <!-- <script>hljs.initHighlightingOnLoad();</script> -->
    <!-- 数式 -->
    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          tex2jax: {
              inlineMath: [ ['$','$'], ['\\(','\\)'] ]
          }
      });
    </script>
  </head>

  <body>
    <nav class="top">
      <ul>
        <li>&nbsp;</li>
        <li>

        <span><a class="ghost">&larr; Previous</a></span>
        </li>
        <li><a href="../index.html"><i class="fas fa-home"></i> Home</a></li>
        <li><a href="../chap/02_basic.html">Next &rarr;</i></a></li>
      </ul>
    </nav>
    <article>
      <h1 id="tufte-css"><div id="top"/>
        1. 導入

      </h1>


      <ul class="signpost"><li>　</li><li><a href="../pdf/jsicp.pdf#page=34" class="external">テキスト： 1.1節</a></li><li><a href="../src/ex.zip" class="internal">配布ファイル： ex.zip</a></li></ul>
      <section><h2>はじめに</h2><p>この演習では，Scheme という名前の関数型プログラミング言語を使ってたくさんのプログラムを記述することで，プログラミングの基礎を実践的に学んでいきます．これまで学んできた C 言語の修得にあまり自信がなくても，講義「プログラミングB」でも用いている<a href="https://github.com/hiroshi-manabe/sicp-pdf" class="external">テキスト</a><label for="side4964" class="margin-toggle sidenote-number"></label><input type="checkbox" id="side4964" class="margin-toggle"/><span class="sidenote">リンク先の <tt>jsicp.pdf</tt> をダウンロードしてください．</span>をしっかり読み進めることで，一からプログラミングの基礎をマスターできます．プログラムを書くための本質的なスキルを身につけるという目標に向けて今からでも十分に挽回可能ですので，しっかりと取り組んでください．</p><p>最初に一つだけとても大切な助言です．このページの内容も含め，「プログラミングB」「プログラミングB演習」のテキストや資料に書かれている内容は，<strong>ざっと斜め読みして雰囲気だけ掴んで理解しようとしたりせず，前から順に一行ずつじっくりと読み進めてください．</strong>斜め読みしただけで理解できるほど浅い内容は扱っていません．最初のうちはそれで良くても，そのうち必ず詰まってしまいます．</p><p>今回の内容は，主に次のとおりです．</p><ol><li>演習に取り組むために必要な開発環境の構築</li><li>課題への取り組み方の説明</li></ol><p>初回ですので，まずは開発環境の準備を行い，それから，簡単なサンプル課題を題材にして演習への取り組み方を具体的に説明します．</p></section><section><h2>準備</h2><p>情報科学科から貸し出しているノート PC にはシェル実行環境（mingw）と Emacs がすでにインストールされていますが，両者の間の連携が十分には設定されていません．また，学年毎に初期設定が少しずつ異なっていたり，そもそも貸与 PC を使っていない学生もいることと思います．そこで，ここでは本演習に必要となるソフトウェアをすべて一から自分でインストールする方法を説明します．<strong>貸与 PC を使っている学生も含め，受講生は必ずここに書かれた手順に従って3つのアプリケーション（MSYS2，Racket，Emacs）を新たにインストールしてください．</strong></p><p>なお，ここでは Windows PC を対象に説明します．macOS や Linux を使用している場合には，担当教員に別途相談してください<label for="side4965" class="margin-toggle sidenote-number"></label><input type="checkbox" id="side4965" class="margin-toggle"/><span class="sidenote">それらのOSにはシェル実行環境が標準で含まれています．また，残りの2つについても，パッケージ管理システムを使っていくつかのコマンドを実行するだけで簡単にインストールできます．</span>．</p><h3>アカウント名のローマ字化</h3><p>ユーザID（正確にはホームディレクトリのパス）に日本語文字が含まれていると後述の Racket 処理系が正常に動作しないことが分かっています．</p><p>1年生後期の授業「プログラミングA演習」でアカウント名の変更を行っていない人は，まず以下の資料に従い<strong>半角ローマ字</strong>のユーザ ID を持つ新規アカウントを作成し，本演習ではそのアカウントを用いるようにしてください．  </p><blockquote><p><a href="../新規アカウント作成手順.pdf" class="internal"><code>新規アカウント作成手順.pdf</code></a></p></blockquote><p>これ以降の手順は<strong>新規アカウントにサインインしてから</strong>行ってください．PCを再起動し，ログイン画面になったらアカウント名に <code>.\&lt;新規アカウント名&gt;</code> を指定してください．<strong>先頭の「<code>.\</code>」を忘れないように要注意．</strong></p><p><anchor id="home"></anchor></p><h3>環境変数 <code>HOME</code> の設定</h3><p>mingw，MSYS2 等，Windows上の仮想UNIX環境では<strong>ホームディレクトリ</strong><label for="side4966" class="margin-toggle sidenote-number"></label><input type="checkbox" id="side4966" class="margin-toggle"/><span class="sidenote">Windows では「ディレクトリ」のことを「フォルダ」と呼びますが，本演習では細かいことは気にせず，どちらの用語も同じ意味で用います．</span>の設定が分かりにくく，Windows 標準のホームディレクトリ（たとえば，ログイン ID が <code>umatani</code> であれば <code>C:\Users\umatani</code>）とは別の場所に設定されてしまいます<label for="side4967" class="margin-toggle sidenote-number"></label><input type="checkbox" id="side4967" class="margin-toggle"/><span class="sidenote">ホームディレクトリとは，自分のデータを保存するための大切な場所です．シェル上では<code>C:\Users\umatani</code> などと入力せず，単に「~」と書くだけで，ログインしているユーザのホームディレクトリを意味します．</span>．ホームディレクトリが Windows 標準の場所とは別の場所に存在していると，たとえばシェルで作業中，（UNIX 環境の存在を知らない）ブラウザがダウンロードしたファイルをどこに保存したのかに戸惑ってしまうなど，非常に紛らわしいです．そこでまずはシェルのホームディレクトリを Windows 標準の場所に設定することにします．</p><p>まず，Windowsの環境設定パネルを開いてください．スタートメニュー中の電源ボタンのすぐ上にある歯車（設定）ボタンを押すと出てきます．検索バーに「環境変数」と入力し「環境変数を編集」を選択してください．</p><figure class=""><label for="fig4968" class="margin-toggle">&amp;#8853;</label><input type="checkbox" id="fig4968" class="margin-toggle"/><a href="../fig/01/ctrlpanel.png"><img src="../fig/01/ctrlpanel.png" alt=""/></a><span class="marginnote"></span></figure><p>「環境変数」パネルの「新規」ボタンを押して，環境変数を新規に追加しください<label for="side4969" class="margin-toggle sidenote-number"></label><input type="checkbox" id="side4969" class="margin-toggle"/><span class="sidenote">ユーザー環境変数の一覧にすでに <code>HOME</code> が含まれている場合には，正しいパスが設定されているか確認し，間違っていれば「編集」ボタンで修正してください．左の画面例では <code>OneDrive</code>，<code>Path</code>，<code>TEMP</code>，<code>TMP</code> だけで <code>HOME</code> はありません．</span>．</p><figure class=""><label for="fig4970" class="margin-toggle">&amp;#8853;</label><input type="checkbox" id="fig4970" class="margin-toggle"/><a href="../fig/01/env_panel.png"><img src="../fig/01/env_panel.png" alt=""/></a><span class="marginnote"></span></figure><p>具体的には，「新しいユーザー変数」パネルへ以下のように入力します．ただし，以下の画面例は，ユーザ ID が<code>umatani</code>の場合にそのホームディレクトリのパスを変数値として設定している例<label for="side4971" class="margin-toggle sidenote-number"></label><input type="checkbox" id="side4971" class="margin-toggle"/><span class="sidenote">何度言っても<code>umatani</code>と入力する人がいるので画像は塗り潰しました．</span>です．<strong>みなさんのユーザ ID が <code>umatani</code> であるはずはありませんので，自分のユーザ ID を調べ，正しい値を設定してください．通常，ユーザ ID が <code>XXXX</code> である場合のホームディレクトリのパスは <code>C:\Users\XXXX</code> です．もしよく分からない場合は，教員に質問してください．</strong></p><figure class=""><label for="fig4972" class="margin-toggle">&amp;#8853;</label><input type="checkbox" id="fig4972" class="margin-toggle"/><a href="../fig/01/newenv_home.png"><img src="../fig/01/newenv_home.png" alt=""/></a><span class="marginnote"></span></figure><p>下の画面のようにリストに追加されれば「OK」を押して設定完了です．</p><figure class=""><label for="fig4973" class="margin-toggle">&amp;#8853;</label><input type="checkbox" id="fig4973" class="margin-toggle"/><a href="../fig/01/env_panel2.png"><img src="../fig/01/env_panel2.png" alt=""/></a><span class="marginnote"></span></figure></section><section><h2>アプリケーションのインストール</h2><p>演習で必要となる各アプリケーション（MSYS2，Emacs，Racket）のインストールには，アプリケーションの導入・更新・削除等を管理するツール <a href="https://scoop.sh" class="external">Scoop</a> を使用します．</p><p><anchor id="scoop"></anchor></p><h3>Scoopのインストール</h3><p>まずは PowerShell を起動してください．Windows タスクバーの検索に「<code>powershell</code>」と入力すると見つかります．</p><figure class=""><label for="fig4974" class="margin-toggle">&amp;#8853;</label><input type="checkbox" id="fig4974" class="margin-toggle"/><a href="../fig/01/new/start_pw.png"><img src="../fig/01/new/start_pw.png" alt=""/></a><span class="marginnote"></span></figure><p>起動したら，PowerShell で以下のコマンドを実行してください．(先頭の <code>PS&gt;</code> は PowerShell のプロンプトです．入力するコマンドの一部ではありませんので，コピペの際に注意してください．）もし途中で yes/no を聞かれたら，すべて yes と答えてください．</p><pre><code class="shell">PS&gt; iex (new-object net.webclient).downloadstring('https://get.scoop.sh')</code></pre><figure class=""><label for="fig4975" class="margin-toggle">&amp;#8853;</label><input type="checkbox" id="fig4975" class="margin-toggle"/><a href="../fig/01/new/scoop1.png"><img src="../fig/01/new/scoop1.png" alt=""/></a><span class="marginnote"></span></figure><p>上記コマンドを実行してみて何かエラーが出るなら，先に以下のコマンドを実行してから，もう一度上のコマンドを実行してみてください．</p><pre><code class="shell">PS&gt; set-executionpolicy remotesigned -scope CurrentUser</code></pre><h3>MSYS2（シェル実行環境）のインストール</h3><p>まずはシェル実行環境を整えます．シェルが提供する様々なコマンドは，効率良くプログラミング作業を進めるのに不可欠です．この演習でもいくつかの基本的なコマンドの便利な使い方を少しずつおしえていきますので，是非とも使いこなせるようになりましょう．</p><p>以下の手順に従って，MSYS2 をインストールしてください．まずは，引き続き PowerShell で以下のコマンドを実行しましょう．</p><pre><code class="shell">PS&gt; scoop install msys2</code></pre><p>下の画面のように「msys2 (2021-02-28) was installed successfully!」と出れば OK <label for="side4976" class="margin-toggle sidenote-number"></label><input type="checkbox" id="side4976" class="margin-toggle"/><span class="sidenote">日付は異なるかもしれません．</span>です．</p><figure class=""><label for="fig4977" class="margin-toggle">&amp;#8853;</label><input type="checkbox" id="fig4977" class="margin-toggle"/><a href="../fig/01/new/msys2_2.png"><img src="../fig/01/new/msys2_2.png" alt=""/></a><span class="marginnote"></span></figure><p>次に，出力の一番最後の行で指示されているとおり，以下のコマンドを実行してください．</p><pre><code class="shell">PS&gt; msys2</code></pre><p>しばらく待って完了したら，<code>exit</code> と2回入力<label for="side4978" class="margin-toggle sidenote-number"></label><input type="checkbox" id="side4978" class="margin-toggle"/><span class="sidenote">1回目は PowerShell の中で動いている MSYS2 の終了，2回目は PowerShell の終了．</span>して PowerShell を終了してください．これ以降，PowerShell は使いません．</p><p>あらためて，Windowsのスタートメニューから「Scoop Apps &gt; MinGW64」<label for="side4979" class="margin-toggle sidenote-number"></label><input type="checkbox" id="side4979" class="margin-toggle"/><span class="sidenote">スタートメニューに一緒に並んでいる MinGW32 や MSYS2 を使ってはいけませんので要注意．</span>を選んで MSYS2 を起動しましょう．なお，これ以降の説明中に出てくるシェルコマンドは，すべてこの MinGW64（これ以降，<strong>シェル端末</strong>と呼ぶことにします）への入力を意味します．</p><figure class=""><label for="fig4980" class="margin-toggle">&amp;#8853;</label><input type="checkbox" id="fig4980" class="margin-toggle"/><a href="../fig/01/new/start_msys2.png"><img src="../fig/01/new/start_msys2.png" alt=""/></a><span class="marginnote"></span></figure><p>まずは，<a href="#home" class="internal">環境変数 <code>HOME</code> の設定</a>で行った設定が上手く反映されているかを確認してみましょう．以下のコマンドを入力してください．</p><pre><code class="shell">$ pwd
/c/Users/umatani</code></pre><p><code>/c/Users/&lt;ユーザID&gt;</code> と返ってくれば上手くいっています．</p><p>ところで，<code>pwd</code> コマンドは現在の作業ディレクトリ（<strong>カレントディレクトリ（<i>current directory</i>）</strong>と呼びます）を表示してくれるコマンドですが，表示結果が Windows における通常のパス表記と異なっていることに気づいたでしょうか．先に環境変数 <code>HOME</code> を設定するときに入力した <code>c:\Users\umatani</code> と同じパスを意味しているのですが，  </p><ol><li>「<code>\</code>」はすべて「<code>/</code>」に置換</li><li>「<code>c:</code>」は「<code>c</code>」に置換</li><li>先頭に余分な「<code>/</code>」を追加</li></ol><p>と変わっています．1 については，UNIX 系 OS の昔からの決まりに従ったものです<label for="side4981" class="margin-toggle sidenote-number"></label><input type="checkbox" id="side4981" class="margin-toggle"/><span class="sidenote">「<code>http://www.kanagawa-u.ac.jp/...</code>」みたいに，URLも「\」ではなく「/」で区切るので，どちらかと言うと Windows の方がマイナーな気がします．</span>．2 については，これも UNIX 系 OS のファイルシステムの方式の一つで，Windows のようにディスクドライブとディレクトリの明確な区別をせず，ディスクドライブも（論理的な）ディレクトリの一つとして扱います．つまり，ここでは単に「<code>c</code>」という名前のつけられたディレクトリを指していることになります．3 については「絶対パス」と呼ばれるファイルシステムの概念が関係しているのですが，<a href="#filepath" class="internal">後で詳しく説明</a>します．</p><p>次に，Scoop を使ってインストールしたアプリケーションを MSYS2 からコマンド実行できるようにパスを設定します．まず，以下のリンク，  </p><blockquote><p><a href="../src/dot.bash_profile" class="internal"><code>dot.bash_profile</code></a></p></blockquote><p>に置かれている設定ファイルをダウンロードしてください<label for="side4982" class="margin-toggle sidenote-number"></label><input type="checkbox" id="side4982" class="margin-toggle"/><span class="sidenote">もしかしたら，ブラウザ（それとも Windows？）が余計なお節介で <tt>dot.bash_profile.txt</tt> みたいな名前に変更するかも知れませんので要注意．</span>．</p><p>ダウンロードが完了したら，設定ファイルを適切な場所へ（名前を変えて）移します．せっかくなので，先ほどインストールしたシェルを使って早速ファイルの移動操作を行ってみましょう<label for="side4983" class="margin-toggle sidenote-number"></label><input type="checkbox" id="side4983" class="margin-toggle"/><span class="sidenote">ブラウザを使ってダウンロードしたファイルが，ホームディレクトリ直下の <code>Downloads</code> ディレクトリに保存されていることを想定しています（日本語版 Windows のファイルエクスプローラ上で「ダウンロード」という名前で表示されているディレクトリです）．もし別の場所に保存されている場合には，適宜読み替えてください．</span>．</p><pre><code class="shell">$ cd
$ mv Downloads/dot.bash_profile .bash_profile</code></pre><p><code>cd</code> コマンド（change directory）は，カレントディレクトリを引数で指定した場所へ変更するコマンドです．上のように引数を指定しなければ，デフォルトでホームディレクトリ（<code>~</code>）へ変更することを意味します．</p><p>次の <code>mv</code> コマンド（move）は，一つ目の引数に指定されたファイルを2つ目の引数へと移動させます．コピーではなく移動なので，元のファイルは消えてなくなります．二つ目の引数に指定したファイルが存在しない場合，その名前で一つ目の引数と同じ内容のファイルを作成しますが，すでにその名前のファイルが存在する場合には上書きします．また，仮に，二つ目の引数がファイルの名前ではなく既に存在するディレクトリの名前であれば，ファイルをそのディレクトリの中へ移動させます．</p><p>なお，移動させるファイルを移動元にも残しておきたい（つまり移動ではなくコピーしたい）場合には，<code>mv</code> コマンドではなく <code>cp</code> コマンド（copy）が使えます．引数の指定方法は <code>mv</code> と同じです．</p><p>ついでに，移動やコピーではなく，ファイルを削除したい場合には <code>rm</code> コマンド（remove）が使えます．  </p><pre><code class="shell">$ rm file1 file2 ...</code></pre><p>とすると，引数に指定したファイルがすべて削除されます．</p><p>最後に，以下のコマンドを実行して，設定ファイルを今実行中のシェルに反映させましょう．</p><pre><code class="shell">$ source .bash_profile</code></pre><p>これで，Scoopでインストールしたアプリケーションをシェルから呼び出せます．</p><p><code>.bash_profile</code> という名前のファイルは，シェル（bash）にとって特別なファイルで，シェルの実行開始時にその中に書かれている設定<label for="side4984" class="margin-toggle sidenote-number"></label><input type="checkbox" id="side4984" class="margin-toggle"/><span class="sidenote">正確には，単なる「設定」ではなく，シェルスクリプトという，これまた別のプログラミング言語で書かれた「プログラム」です．</span>がすべて読み込まれます．最後の入力行の「<code>source .bash_profile</code>」は，たった今更新したばかりの設定内容を現在実行中のシェルに反映させるためのコマンドです．</p><p><code>.bash_profile</code>ファイルの中身を少し覗いてみましょう．</p><pre><code class="shell">$ cat .bash_profile</code></pre><p><code>cat</code>は，引数に指定したファイルの中身をシェル端末に表示するコマンドです．数行程度の短いファイルを読むだけであれば，わざわざテキストエディタで開くより手軽に中身を確認できます．</p><p>「<code>export PATH=...</code>」は，実行可能プログラムを探す場所（ディレクトリ）の一覧を含む環境変数 <code>PATH</code> を，<code>=</code> の右辺に書かれている文字列にセットすることを意味します．また，ここでは，右辺の末尾に <code>$PATH</code> と書かれていますが，これはセットする直前に環境変数 <code>PATH</code> に含まれている値を参照しています．つまり，C言語コードにたとえるなら，  </p><div class="highlight"><pre><code>int PATH = 0;
PATH = 1 + PATH;</code></pre></div><p>の2行目を書いているようなものです<label for="side4985" class="margin-toggle sidenote-number"></label><input type="checkbox" id="side4985" class="margin-toggle"/><span class="sidenote">もちろん今回は整数の足し算ではなく，文字列の連結を行っています．</span>．</p><p>今回の演習の一番始めに，Windows のコントロールパネルを使って環境変数 <code>HOME</code> を設定したことを覚えているでしょうか．MSYS2 の世界の環境変数は，コントロールパネルではなく上記の方法によって設定する必要があります．</p><h3>Emacs のインストール</h3><ol><li><p>インストール</p><p>シェル端末から以下の3つのコマンドを順に入力してください．  </p><pre><code class="shell">$ scoop install git
$ scoop bucket add extras
$ scoop install emacs</code></pre></li><p> </p><li><p>動作確認</p><p>そのまま，シェル端末から次のコマンドを入力して Emacs を起動してみてください．  </p><pre><code class="shell">$ runemacs</code></pre><p>下のようなウィンドウが表示されれば OK です．ウィンドウ右上の &#10062; ボタンを押して Emacs を一旦終了させてください<label for="side4986" class="margin-toggle sidenote-number"></label><input type="checkbox" id="side4986" class="margin-toggle"/><span class="sidenote">Emacsの「より正しい」終了方法は後ほど説明します．</span>．</p><figure class="fullwidth"><label for="fig4987" class="margin-toggle">&amp;#8853;</label><input type="checkbox" id="fig4987" class="margin-toggle"/><a href="../fig/01/emacs/vanilla_emacs.png"><img src="../fig/01/emacs/vanilla_emacs.png" alt=""/></a><span class="marginnote"></span></figure></li><p><anchor id="init-el"></anchor></p><li><p>設定ファイルの設置</p><p>Emacs を快適に利用するには，便利な Emacs パッケージをインストールしたり，操作方法や見た目をカスタマイズしたり，記述するプログラミング言語に特有の設定をしたりと，それなりの準備が必要になります．</p><p>本演習では，快適に課題に取り組むための設定をすべて含んだ設定ファイルを用意しています．以下のリンク，  </p><blockquote><p><a href="../src/init.el" class="internal"><code>init.el</code></a></p></blockquote><p>に置かれているファイルをダウンロードして使用してください．手順 2 で一度 Emacs を起動していれば，ホームディレクトリの中に <code>.emacs.d</code> という名前のディレクトリが作られているはずです．その中に，ダウンロードしたファイルを必ず同じ名前（<code>init.el</code>）のままで置く必要があります．先ほどの MSYS2 の設定ファイル（<code>.bash_profie</code>）と同様に，シェルを使って以下のファイル移動操作を行いましょう．  </p><pre><code class="shell">$ cd ~/Downloads/
$ mv init.el ../.emacs.d/</code></pre><p>この場合の <code>cd</code> コマンドは，カレントディレクトリをホームディレクトリ（<code>~</code>）直下の <code>Downloads</code> ディレクトリへ変更しています．</p><p>次の <code>mv</code> では，二つ目の引数としてディレクトリの名前を指定していますので，「カレントディレクトリ中にある <code>init.el</code> という名前のファイルを，<code>.emacs.d</code> ディレクトリの中に移動させる」を行っています<label for="side4988" class="margin-toggle sidenote-number"></label><input type="checkbox" id="side4988" class="margin-toggle"/><span class="sidenote"><code>.emacs.d/</code> の前についている「<code>../</code>」は後ほど説明します．</span>．</p></li><p> </p><li><p>再起動</p><p>ネットワークに接続されていることを確認してから，再度 <code>runemacs</code> コマンドで Emacs を起動してください．パッケージのダウンロード＆インストールにしばらく時間がかかります．下の画面のように，ウィンドウ下半分に「Warning...」などと書かれたメッセージが表示されれば完了です．&#10062; ボタンを使って，また Emacs を一旦終了させてください．</p><figure class="fullwidth"><label for="fig4989" class="margin-toggle">&amp;#8853;</label><input type="checkbox" id="fig4989" class="margin-toggle"/><a href="../fig/01/emacs/emacs_init.png"><img src="../fig/01/emacs/emacs_init.png" alt=""/></a><span class="marginnote"></span></figure><p>次回以降の起動ではパッケージのインストールはスキップされ，すぐさま下のような（背景色やツールボタンの有無などが異なる）画面が表示されるはずです．</p><figure class="fullwidth"><label for="fig4990" class="margin-toggle">&amp;#8853;</label><input type="checkbox" id="fig4990" class="margin-toggle"/><a href="../fig/01/emacs/emacs_start.png"><img src="../fig/01/emacs/emacs_start.png" alt=""/></a><span class="marginnote"></span></figure></li></ol><h3>Racket のインストール</h3><p>Racket は演習で用いるプログラミング言語 Scheme の実装（言語処理系と呼ばれます）の一つです．</p><ol><li><p>インストール</p><p>シェル端末から以下のコマンドを入力してください．  </p><pre><code class="shell">$ scoop install racket</code></pre></li><li><p>動作確認</p><p>Racket を実行するコマンドは <code>racket</code> です．起動できるか，実行して確認してみましょう．次のように表示されれば OK です．プロンプト <code>&gt;</code> の右側に <code>(exit)</code> と入力<label for="side4991" class="margin-toggle sidenote-number"></label><input type="checkbox" id="side4991" class="margin-toggle"/><span class="sidenote">これは，<code>exit</code> という名前の手続きを引数なしで呼び出している Scheme コードです．手続き呼出しは，もうテキストで学びましたよね！</span>して，一旦終了させてください．  </p><pre><code class="shell">$ racket
Welcome to Racket v8.0 [cs].
&gt; (exit)   ;; 手続きexitを呼び出すとracketが終了</code></pre></li></ol><h3>その他</h3><p>Scoop でインストールした全てのアプリケーションをまとめて最新にアップデートできます<label for="side4992" class="margin-toggle sidenote-number"></label><input type="checkbox" id="side4992" class="margin-toggle"/><span class="sidenote">スマホのアプリもこんな感じに一括でアップデートできますよね．それと同じです．</span>．以下のコマンドを <strong>PowerShell 上で</strong><label for="side4993" class="margin-toggle sidenote-number"></label><input type="checkbox" id="side4993" class="margin-toggle"/><span class="sidenote">MSYS2 のシェル端末ではないので要注意．</span>定期的に実行することをお勧めします．  </p><pre><code class="shell">PS&gt; scoop update</code></pre><p>他にも色々と便利な機能があります．詳しくはググってみてください．また，Emacs や Racket 以外にも数多くのアプリケーションが Scoop で提供されています．たとえば，Visual Studio Code も Scoop でインストール・管理が可能<label for="side4994" class="margin-toggle sidenote-number"></label><input type="checkbox" id="side4994" class="margin-toggle"/><span class="sidenote"><code>scoop install vscode</code></span>です．</p></section><section><h2>基本的な使い方</h2><p>前節まででひと通りのインストール作業が完了しましたので，ここからはインストールしたアプリケーションの基本的な使い方の説明に移ります．</p><p>先程は <code>racket</code> コマンドをシェルから起動して動作確認を行いました．しかし，実際の Scheme プログラミングでは，Emacs の中から <code>racket</code> コマンドを呼び出すことにより，編集中のプログラムを直接実行することがほとんどで，その方がずっと簡単です．まずはその方法から始めましょう．これまでと同じようにシェル端末で <code>runemacs</code> を実行して，Emacs を起動してください．</p><p>Emacs でファイルを新規作成するには（実際には，ファイルの新規作成に限らずほとんどすべての操作は），Windows のショートカットキーのような操作を行う必要があります．キーボードから，</p><blockquote><p>Ctrl キー（コントロールキー）を押しながら同時に x キーを押し，次に，Ctrl キーを押しながら同時に f キーを押す</p></blockquote><p>と入力してみてください<label for="side4995" class="margin-toggle sidenote-number"></label><input type="checkbox" id="side4995" class="margin-toggle"/><span class="sidenote">Ctrl キーはずっと押しっぱなしで，x キーから指を離し，つづけて f キーを押すのがコツです．</span>．そうすると，Emacs の画面の一番下に次のような文字列が表示され，そこにカーソルが移動するはずです．</p><figure class=""><label for="fig4996" class="margin-toggle">&amp;#8853;</label><input type="checkbox" id="fig4996" class="margin-toggle"/><a href="../fig/01/emacs/c-x-c-f.png"><img src="../fig/01/emacs/c-x-c-f.png" alt=""/></a><span class="marginnote"></span></figure><p>ここではホームディレクトリのすぐ下に <code>sample.rkt</code> という名前でファイルを作成しましょう．Scheme ソースファイル（正確には Racket ソースファイル）の拡張子は <code>rkt</code> とするのが慣習です．カーソルのある場所に，下の画面のように入力した後，Enter キーを押してください．</p><figure class=""><label for="fig4997" class="margin-toggle">&amp;#8853;</label><input type="checkbox" id="fig4997" class="margin-toggle"/><a href="../fig/01/emacs/c-x-c-f-2.png"><img src="../fig/01/emacs/c-x-c-f-2.png" alt=""/></a><span class="marginnote"></span></figure><p>下の画面のように，新規ファイルが画面全体に表示されます．画面下方にある現在開いているファイルの名前が <code>sample.rkt</code> になっていることも確認できるはずです．</p><figure class=""><label for="fig4998" class="margin-toggle">&amp;#8853;</label><input type="checkbox" id="fig4998" class="margin-toggle"/><a href="../fig/01/emacs/sample-rkt1.png"><img src="../fig/01/emacs/sample-rkt1.png" alt=""/></a><span class="marginnote"></span></figure><p>ここで話が少し逸れますが，Emacs におけるショートカットキー（キーバインディングと呼びます）の表記法について説明します．たとえば先程の，</p><blockquote><p>Ctrl キーを押しながら同時に x キーを押し，次に，Ctrl キーを押しながら同時に f キーを押す</p></blockquote><p>は，短く「C-x C-f」と表すことにします．C-○ は「Ctrl キーと ○ キーの同時押し」を意味し，二つ以上続けて並んでいる場合には，それらを順に押すことを意味します．これ以降も様々なキーバインディングを紹介しますので，この読み方を必ず覚えてください．</p><p>では次に，テキストの最初の方に出てくる Scheme コードを，今開いた <code>sample.rkt</code> に書いてみましょう．操作方法を習うための練習ですから，このページからコピペしたりせず，1文字ずつ自分で入力してみてください．</p><div class="highlight"><pre><code>#lang racket

(define pi 3.14159)
(define radius 10)

(define area (* pi (* radius radius)))

(define circumference (* 2 pi radius))</code></pre></div><p>1行目の「<code>#lang racket</code>」はテキストには出てこないコードですが，Racket 言語処理系で実行するための Scheme プログラムを書くときの決まり事です．今後，すべての Scheme ソースファイルの先頭には必ず同じように書くようにしてください．</p><p>さて，短いコードですが，1文字ずつ自分で入力するうちに打ち間違いをして書き直したり，書き間違えている箇所を後から修正したりしなかったでしょうか？その際，矢印キーでカーソルを移動させたり，Delete キーや Backspace キーを使って文字を削除したりしたのではないでしょうか？</p><p>Emacs には，カーソル移動や文字の削除を行うのに，それらとは別にキーバインディングが用意されています．</p><ul><li>C-f： 1文字右（前方，forward）へ移動</li><li>C-b： 1文字左（後方，backward）へ移動</li><li>C-n： 1行下（次，next）へ移動</li><li>C-p： 1行上（前，previous）へ移動</li></ul><p>視覚的に表すと次のようになります．</p><pre><code>            C-p
             ↑
C-b ← 現在のカーソル位置 → C-f
             ↓
            C-n</code></pre><p>また，カーソルがある位置の文字を削除するには C-d，カーソル直前の一文字を削除するには C-h を押します．「1文字打ってすぐ打ち間違いに気づく」なんてことは日常茶飯事ですから，Emacs を使っていて最も頻繁に使うキーバインディングはこの C-h かも知れません<label for="side4999" class="margin-toggle sidenote-number"></label><input type="checkbox" id="side4999" class="margin-toggle"/><span class="sidenote">打ち間違いが多いのは，単に私の手癖が悪いだけかも&#128531;</span>． キーボードでスラスラとプログラムや文章を入力するためには，指をホームポジション<label for="side5000" class="margin-toggle sidenote-number"></label><input type="checkbox" id="side5000" class="margin-toggle"/><span class="sidenote">左手と右手の指を，それぞれ左から順に「asdf」「jkl;」キーの上に置くのがホームポジション．</span>からなるべく外さないことが非常に重要です．矢印キーや Delete キー，Backspace キーはホームポジションから遠くて素早い入力を中断してしまうため，このようなキーバインディングが用意されています<label for="side5001" class="margin-toggle sidenote-number"></label><input type="checkbox" id="side5001" class="margin-toggle"/><span class="sidenote">矢印キーがなかった頃の負の遺産だなんていう人もいますが，こちらの方が格段に高速タイピングできるのは確かです．</span>．キーバインディングを素早く，かつ，楽に入力するためのちょっとした工夫については次節で説明します．</p><p>話を戻しましょう．入力が完了したらファイルに一旦保存します．変更内容がまだファイルに保存されていない場合，下の画面のように，未保存状態であることを知らせる「<code>**</code>」マークがファイル名の左に表示されています．</p><figure class=""><label for="fig5002" class="margin-toggle">&amp;#8853;</label><input type="checkbox" id="fig5002" class="margin-toggle"/><a href="../fig/01/emacs/sample-rkt2.png"><img src="../fig/01/emacs/sample-rkt2.png" alt=""/></a><span class="marginnote"></span></figure><p>ファイルへの保存を行うキーバインディングは C-x C-s です．実行すると，</p><figure class=""><label for="fig5003" class="margin-toggle">&amp;#8853;</label><input type="checkbox" id="fig5003" class="margin-toggle"/><a href="../fig/01/emacs/sample-rkt3.png"><img src="../fig/01/emacs/sample-rkt3.png" alt=""/></a><span class="marginnote"></span></figure><p>のように，ファイルに書き込んだことを知らせるメッセージが表示され，未保存状態マークが消えます．</p><p>以上のようにして保存したファイルを再度開くには，ファイルを新規作成した時と同じ操作の C-x C-f を行ってから，開きたいファイル名を指定してください．C-x C-f は実は「ファイルを開く」操作であり，そのファイルが存在しない場合にだけ「新規作成」という意味になります．</p><p>さて，いよいよ <code>sample.rkt</code> 中のプログラムを Emacs の中で動かしてみましょう．<code>sample.rkt</code> ファイルの中にカーソルがある状態で C-c C-k （あるいは C-c C-c）と打ってください．以下のように画面が上下二つに分割されます．</p><figure class=""><label for="fig5004" class="margin-toggle">&amp;#8853;</label><input type="checkbox" id="fig5004" class="margin-toggle"/><a href="../fig/01/emacs/repl-start.png"><img src="../fig/01/emacs/repl-start.png" alt=""/></a><span class="marginnote"></span></figure><p>下半分の画面は，実行を開始した Racket の対話環境<label for="side5005" class="margin-toggle sidenote-number"></label><input type="checkbox" id="side5005" class="margin-toggle"/><span class="sidenote">プログラマと言語処理系が対話する場所なのでこう呼ばれます．</span>です．C-c C-k で開始させると <code>sample.rkt</code> 中のコードは処理系の実行開始時に同時に実行されていますので，変数 <code>pi</code>，<code>radius</code>，<code>area</code>，<code>circumference</code> がすでに定義された状態です．</p><p>カーソルを <code>sample.rkt</code> から対話環境へ移すには，C-c C-z と入力してください．対話環境から <code>sample.rkt</code> へカーソルを戻したい場合にも同じく C-c C-z です．同じキーバインディングで行ったり来たりできます．</p><p>以下の画面のとおりに Racket と対話して，<code>sample.rkt</code> 中で定義されている変数や Scheme 言語標準の手続きを使えることを確認してみましょう．画面中の対話環境を見ると分かるように，そこで定義を新しく追加することも可能です．ただし，対話環境に入力した内容はファイルには保存されません．あくまで一時的に使用するコードを入力するための場所と考えてください．</p><figure class=""><label for="fig5006" class="margin-toggle">&amp;#8853;</label><input type="checkbox" id="fig5006" class="margin-toggle"/><a href="../fig/01/emacs/repl-interaction.png"><img src="../fig/01/emacs/repl-interaction.png" alt=""/></a><span class="marginnote"></span></figure><p><code>sample.rkt</code> に定義を追加したり，内容を修正したりした場合には，<code>sample.rkt</code> にカーソルを移して再度 C-c C-k を実行してください．その都度，最新のコードが対話環境に読み込まれます．変数や手続きの定義だけでなく，式を書いておくと，C-c C-k を実行することでその式も評価され，評価結果がただちに表示されます（たとえば，下図では，式 <code>(* circumference 20)</code> の評価結果が表示されている）．</p><figure class=""><label for="fig5007" class="margin-toggle">&amp;#8853;</label><input type="checkbox" id="fig5007" class="margin-toggle"/><a href="../fig/01/emacs/repl-start2.png"><img src="../fig/01/emacs/repl-start2.png" alt=""/></a><span class="marginnote"></span></figure><p>Racket プログラムを Emacs 上で編集＆実行する方法の説明は以上です．この節のとおりに実行できない場合には，遠慮せず教員に質問・相談してください．</p><p>Emacs を終了するには C-x C-c と入力して下さい．未保存状態のファイルがある場合には，保存するか確認されますので適宜入力（保存するなら「y」）してください．</p><p>最後に，様々なキーバインディングを入力中，途中で止めたくなることがあると思います．たとえば，C-x C-f がしたいのに間違って最初に C-c を押してしまうことはあると思います．そんな時には続けて C-g を押してください．どんな操作を入力中であっても，C-g を押すことで実行中の操作を中断することが可能です<label for="side5008" class="margin-toggle sidenote-number"></label><input type="checkbox" id="side5008" class="margin-toggle"/><span class="sidenote">私は，C-h の次かそれと同じくらい頻繁に入力します．</span>．</p><p>色々なキーバインディングを紹介して一度には覚えきれないと思います．また，最初はこれらのキーバインディングを面倒に感じるかも知れません．ですが，今回紹介した程度の基本操作は，使っているうちにすぐ指が勝手に覚えてしまうと思います．とはいえ，指が覚えてくれるまで参照しやすいよう，今回のキーバインディングの一覧を<a href="#literacy-table" class="internal">ページ末尾</a>にまとめています．慣れるまでは，そこを常に画面に表示しながら，Emacs で編集作業を行うと良いでしょう．おすすめの画面構成はこんな感じです（右半分にEmacs，左半分にキーバインディング一覧を表示したブラウザ）．</p><figure class=""><label for="fig5009" class="margin-toggle">&amp;#8853;</label><input type="checkbox" id="fig5009" class="margin-toggle"/><a href="../fig/01/emacs/screen.png"><img src="../fig/01/emacs/screen.png" alt=""/></a><span class="marginnote"></span></figure><h3>追加のカスタマイズ</h3><blockquote><p><i>注意： この節に書かれているキーボード設定のカスタマイズに関する説明には，担当教員の主観が含まれています．少しでも快適で使いやすい開発環境の下でプログラミングを楽しんで貰えるようにと書いたつもりですが，「現状のキーボード設定で Emacs を触ってみてまったく不満はない」「ここに書かれている設定を試してみたが気に入らない」というようであれば無視してください．</i></p></blockquote><p>前節の基本的な使い方の説明だけでも分かるとおり，Emacs では Ctrl キーとMeta キー（Windows では左 Alt キー）を同時に押しながら各種の編集操作を行うのが常です<label for="side5010" class="margin-toggle sidenote-number"></label><input type="checkbox" id="side5010" class="margin-toggle"/><span class="sidenote">今回は Meta キーを使うキーバインディングは一つも紹介しませんでしたが，次回以降たくさん出てきます．</span>．カーソル移動をそのようなキーバインディング（C-f 等）で行うことのメリットの一つは，矢印キーを押すために指をわざわざホームポジションから外す手間を省けることです．最初は Ctrl キーとの同時押しが慣れないかも知れませんが，慣れてくると矢印キーを押すためにわざわざ指を遠くまで移動させることの方がとても面倒に感じると思います．</p><p>しかし，肝心の Ctrl キーと Meta キーがホームポジションから遠く離れた位置にあったのでは，それらのキーとの同時押しにストレスを感じるのも事実です．そこで，キーの配置を自由にカスタマイズできるアプリケーションを使って，Ctrl キーと Meta キーを楽に押すことのできる位置へ移してしまいましょう．</p><p>ここでは，Windows の KeySwap というアプリケーションを使ってキー配置を変更する方法について説明します<label for="side5011" class="margin-toggle sidenote-number"></label><input type="checkbox" id="side5011" class="margin-toggle"/><span class="sidenote">macOS や Linux にも方法はあります．担当教員に相談してください．</span>．まず，</p><p>  <a href="https://www.vector.co.jp/soft/dl/winnt/util/se228667.html" class="external">https://www.vector.co.jp/soft/dl/winnt/util/se228667.html</a></p><p>からアプリケーションをダウンロードしてください（下図の「ダウンロードページへ」ボタンをクリック）．</p><figure class=""><label for="fig5012" class="margin-toggle">&amp;#8853;</label><input type="checkbox" id="fig5012" class="margin-toggle"/><a href="../fig/01/keyswap/keyswap-top2.png"><img src="../fig/01/keyswap/keyswap-top2.png" alt=""/></a><span class="marginnote"></span></figure><p>ダウンロードした zip ファイルを展開すると，<code>KeySwap.exe</code> という実行可能ファイルがあります．それを右クリックし「管理者として実行」を実行してください．</p><p>使い方は見た目どおり簡単ですので，何となく分かると思います．ここでは，担当教員おすすめのキー配置を行うための画面を紹介しておきます．下の画面のように設定した後，設定内容を適当な名前のファイルへ保存し，「終了」ボタンを押すと登録するか確認されるので「はい(Y)」と答えます．その後，設定を有効化するため，一度 Windows を再起動してください．</p><figure class=""><label for="fig5013" class="margin-toggle">&amp;#8853;</label><input type="checkbox" id="fig5013" class="margin-toggle"/><a href="../fig/01/keyswap/keyswap2.png"><img src="../fig/01/keyswap/keyswap2.png" alt=""/></a><span class="marginnote"></span></figure><p>このおすすめ配置では，CapsLock キー（つまり A のすぐ左）を Ctrl キーに，変換キー（つまりスペースキーのすぐ右）を左 Alt キーにしています．なお，左 Alt キーと右 Alt キーは，Windows 版 Emacs では異なる挙動をします．<strong>Meta キーとして動作するのは 左 Alt キーの方だけ</strong>ですので注意してください．</p><p>この配置であれば，それぞれのキーが左の小指と右の親指のすぐ近くにあるので，楽に押せます．さらに，（今回はそのような操作を紹介していませんが）Ctrl キーと Meta キーの両方を同時に押しながらさらに別のキーを押すような場合でも，それぞれのキーを左手と右手で別々に押すため，かなり楽に行うことができます<label for="side5014" class="margin-toggle sidenote-number"></label><input type="checkbox" id="side5014" class="margin-toggle"/><span class="sidenote">最低限，Ctrl キーと Meta キーを左右別々の指で押せるようにしておくことを強くおすすめします．</span>．</p><p>ここまでの説明を読んで上記以外のこれといった配置を思いつかない人は，騙されたと思って，しばらくはこのおすすめ設定のままで使ってみましょう．</p></section><section><h2>課題について</h2><p>ここまでで演習に必要な環境の構築，および，各ソフトウェアの最低限の使い方を理解できたはずです．それでは次に，本演習で取り組む課題について説明します．</p><h3>概要</h3><p>この演習では，基本的に，テキスト中に出てくる問題を順に解いていきます．</p><p>各回のホームページには，</p><div class="exercise"><h4>課題1.1 [★] [<a href="01_intro_ex1.html" class="external">テキスト中の問題文へのリンク</a>]</h4><p><p>リンク先のテキスト問題1.0を解きなさい．配布ファイル <code>ex01/ex01-1.rkt</code> に解答コードを書き加えて完成させること．</p><p><i>&lt;適宜，ここに追加説明が書かれることもある&gt;</i></p></p></div><p>のような課題がいくつか並んでいますので，これを上から順番に解いていってください（この課題は説明のための例題です）．</p><p>課題番号の右に並んでいる★の数は，課題の難易度（★が増えるほど難しくなる）を表しています．またその右には，各課題に対応する日本語版テキストの問題へのリンクが付いています．どの課題もリンク先の問題文をよく読んでから取り組む必要があります．ただし，リンク先は公式版の HTML ページです．<a href="https://github.com/hiroshi-manabe/sicp-pdf" class="external">非公式日本語版翻訳改訂版</a>で読んでいる人<label for="side5015" class="margin-toggle sidenote-number"></label><input type="checkbox" id="side5015" class="margin-toggle"/><span class="sidenote">それがおすすめです．</span>は，適宜 PDF の該当箇所を見てください．</p><p>課題を解くにあたっては，演習用の配布ファイルを使用します．各回のトップ見出しのすぐ下に<a href="#top" class="internal">「配布ファイル： ○○.zip」</a>というボタンがありますので，そこからダウンロードしてください．中に入っているファイルの具体的な使い方については，このあとすぐに説明します．</p><p>課題の提出期限は，毎回，<strong>翌週の水曜19時00分</strong>とします．WebClass に各回毎の課題提出先が用意されていますので，そこへ必ず<strong>指定されたとおりのファイル名</strong>で提出してください．</p><p><strong>重要：必ず以下の「課題への取り組み方」のすべてに目を通し，そこに書かれた手順に従って提出してください．手順に従っていない提出物は評価できませんので，くれぐれも注意してください．</strong></p><h3>課題への取り組み方</h3><p>先程の課題1.1を例に，実際に課題に取り組む際の具体的な作業の流れを説明します．</p><p>まずは，ダウンロードした<a href="#top" class="internal">配布ファイル</a>を展開しましょう．何でもかんでもホームディレクトリの下に展開していては整理整頓のできないだらしない人と思われかねませんから，この際，演習専用のディレクトリをつくってしまいましょう．</p><p>たとえば，今ホームディレクトリにいるとして，次のように <code>mkdir</code> コマンド（make directory）を使ってディレクトリをつくります<label for="side5016" class="margin-toggle sidenote-number"></label><input type="checkbox" id="side5016" class="margin-toggle"/><span class="sidenote">「<code>mkdir -p lecture/2022/pbe</code>」みたいに，一度につくってしまうための <code>-p</code> オプションというのもあります．</span>．この例では，すべての授業用ディレクトリ（<code>lecture</code>）をさらに年度毎に分けてたりしますが，その辺の整理の仕方は自分の好みに合わせて決めてください．その場合，以降の説明は適宜自分で読み替えてください．</p><pre><code class="shell">$ mkdir lecture
$ mkdir lecture/2022
$ mkdir lecture/2022/pbe/</code></pre><p>ダウンロードした配布ファイルが <code>~/Downloads</code> の下にあるとします．</p><pre><code class="shell">$ ls Downloads
desktop.ini ex.zip
$ mv Downloads/ex.zip lecture/2022/pbe/
$ cd lecture/2022/pbe/</code></pre><p>として，演習用ディレクトリに配布ファイルを移し，そのディレクトリに移動してください．</p><p>次に，<code>unzip</code> コマンドを使って配布ファイルを展開します．</p><pre><code class="shell">$ ls
ex.zip
$ unzip ex.zip
bash: unzip: コマンドが見つかりません</code></pre><p>…っと，まだ <code>unzip</code> コマンドをインストールしてませんでした．Scoop を使って（ついでに後で使うことになる <code>zip</code> コマンドも一緒に）インストールしましょう．</p><pre><code class="shell">$ scoop install unzip zip</code></pre><p>それでは，リトライです．</p><pre><code class="shell">$ unzip ex.zip
Archive:  ex.zip
   creating: ex/
   creating: ex/ex01/
   ...
$ ls
ex  ex.zip</code></pre><p>のように <code>ex</code> ディレクトリが出来ていれば成功です．</p><p><anchor id="filepath"></anchor>ここで少し話が逸れますが，ファイルシステムにおける「絶対パス」と「相対パス」の違いと，それらのシェルでの効率良い使い分けについて説明しておきます．</p><p>たとえば，先程の実行手順中の，</p><pre><code class="shell">$ ls Downloads
desktop.ini ex.zip
$ mv Downloads/ex.zip lecture/2022/pbe/
$ cd lecture/2022/pbe/</code></pre><p>に出てくる <code>Downloads</code>，<code>Downloads/ex.zip</code>，<code>lecture/2022/pbe/</code> は，先頭に「<code>/</code>」がないため，すべて相対パスです．読んで字の如く，相対パスはカレントディレクトリからの相対位置を指定する場合に使います．</p><p>一方，「絶対パス」は「ファイルシステム全体の一番上（外側）」からの位置によってファイルやディレクトリを指定する方法で，先頭の「<code>/</code>」が「一番上（外側）」を表しています．たとえば先に紹介した <code>pwd</code> コマンドは，カレントディレクトリの絶対パスを表示します．</p><pre><code class="shell">$ pwd
/c/Users/umatani</code></pre><p>この場所にいる状態で，相対パス <code>Downloads/ex.zip</code> によってファイルを指定するというのと，絶対パス <code>/c/Users/umatani/Downloads/ex.zip</code> によってファイルを指定するのは，まったく同じ意味になります．<code>/c/Users/umatani/lecture/2022/pbe/</code> のようにディレクトリの整理整頓をするとどうしてもパスが長くなってくるため，一般的には相対パスを使ってファイルを指定する方が簡単です．</p><p>PC のファイルシステムでの説明が分かりにくいようなら，「現実世界の住所」に置き換えて考えてみましょう．たとえば，湘南ひらつかキャンパス内にいる人を私の部屋に呼ぶとき，</p><blockquote><p>銀河系の太陽系の地球の日本の神奈川県の平塚市の神奈川大学湘南ひらつかキャンパスの2号館の227室までお越しください</p></blockquote><p>なんてまどろっこしいことを言うはずがなく，</p><blockquote><p>2号館の227室までお越しください</p></blockquote><p>で済ませるに違いありません．前者が絶対パス，後者が相対パスです．</p><p>せっかくなので，もう少したとえ話で続けます．今度は，227室まで到着した人に次の移動先をおしえたいとします．その場合，</p><blockquote><p>この部屋を出て226室を訪ねてください</p></blockquote><p>とは言っても，</p><blockquote><p>銀河系の太陽系の地球の日本の神奈川県の平塚市の神奈川大学湘南ひらつかキャンパスの2号館の226室を訪ねてください</p></blockquote><p>とはやっぱり言いませんし，もう少し遠くへ移動してもらう場合でも，</p><blockquote><p>この部屋を出てこの建物を出て<label for="side5017" class="margin-toggle sidenote-number"></label><input type="checkbox" id="side5017" class="margin-toggle"/><span class="sidenote">これもちょっとまどろっこしく感じるかも知れませんが，たとえばこのキャンパスに来るのが初めての小学生にでも説明すると思ってください．</span>，6号館に入って305講義室に移動してください</p></blockquote><p>とは言っても，</p><blockquote><p>銀河系の太陽系の地球の日本の神奈川県の平塚市の神奈川大学湘南ひらつかキャンパスの6号館の305講義室に移動してください</p></blockquote><p>とは言わないはずです．</p><p>これらの日本語表現中の「○○を出て」を意味する相対パスが「<code>..</code>」で，「現在いる場所から一つ外へ出る」を意味します<label for="side5018" class="margin-toggle sidenote-number"></label><input type="checkbox" id="side5018" class="margin-toggle"/><span class="sidenote">ちなみに，電話番号の先頭の0（ゼロ）もこの「<code>..</code>」と同じ意味だというのを知ってましたか？</span>．たとえば，上の二つの日本語の例をシェルの相対パス風に書くと，</p><pre><code class="shell">$ cd ../226室</code></pre><p>や</p><pre><code class="shell">$ cd ../../6号館/305講義室</code></pre><p>となります．</p><p>相対パスの便利さが少しは伝わったでしょうか？普段いる部屋（私の場合227室）を起点に話をすると楽なのと同じように，この演習では各回の課題ファイルの置かれたディレクトリに <code>cd</code> で移動し，そこからの相対パスで色々な作業を行うと楽です．先程，<code>unzip</code> コマンドを実行した際に <code>lecture/2022/pbe</code> ディレクトリまでは移動してますので，さらに，</p><pre><code class="shell">$ cd ex/ex01</code></pre><p>として，今回の課題のディレクトリに移っておきましょう．引数を指定しない <code>ls</code> コマンド（list）で，</p><pre><code class="shell">$ ls
ex01-1.rkt ex01-3.rkt README.md
ex01-2.rkt ex01-4.rkt</code></pre><p>のように今回用のソースファイル一式が見えるはずです．</p><p>課題1.1を再掲します．</p><div class="exercise"><h4>課題1.1 [★] [<a href="01_intro_ex1.html" class="external">テキスト中の問題文へのリンク</a>]</h4><p><p>リンク先のテキスト問題1.0を解きなさい．配布ファイル <code>ex01/ex01-1.rkt</code> に解答コードを書き加えて完成させること．</p><ol><li>ソースファイル中で定義済みの変数 <code>width</code> と <code>height</code> の値を掛けた結果を含む変数 <code>area</code> を定義しなさい．</li><li>長方形の幅と高さを引数に受け取って，その面積を返す手続き <code>rectangle-area</code> を定義しなさい．</li><li>半径 <code>r</code> を引数に受け取って円の面積を求める手続き <code>circle-area</code> を定義しなさい．ただし，円周率はソースファイル中で定義されている変数 <code>pi</code> の値としなさい．また，二乗を計算するには，同じくソースファイル中で定義されている手続き <code>square</code> を用いること．</li></ol><p>いずれも，ソースファイル中の <code>(???)</code> を書き換えることで完成させること．それ以外のところを書き換えてはいけません．</p></p></div><p>今は <code>ex01</code> ディレクトリの中にいますので，課題1.1用のソースファイルは <code>ex01-1.rkt</code> です．早速 Emacs で開いてみましょう．</p><pre><code class="shell">$ runemacs</code></pre><p>で Emacs を起動してから C-x C-f でした<label for="side5019" class="margin-toggle sidenote-number"></label><input type="checkbox" id="side5019" class="margin-toggle"/><span class="sidenote">カレントディレクトリを <code>ex01</code> にしてあるので，Emacs の中でファイルを指定する際の起点も変わっていることに気づいたでしょうか？</span>．</p><div class="filename" decode="exclude">ex01-1.rkt</div><div class="highlight"><pre><code>#lang racket
(require rackunit)
(require "../misc.rkt")

;;;; 課題1.1（この課題は，本演習における課題の解き方を説明するための例題です．）

;; (1) width と height の値を掛けた結果を含む変数 area を定義しなさい．
;;
;; (2) 長方形の幅と高さを引数に受け取って，その面積を返す手続き
;;    rectangle-area を定義しなさい．
;;
;; (3) 半径 r を引数に受け取って円の面積を求める手続き circle-area
;;    を定義しなさい．ただし，円周率はこのファイルで定義されている
;;    変数 pi の値としなさい．また，二乗を計算するには，同じくこの
;;    ファイルで定義されている手続き square を用いること．

;; いずれも，下の (???) を書き換えることで完成させること．
;; それ以外のところを書き換えてはいけません．

(define width 128) ; 幅
(define height 96) ; 高さ

(define pi 3.14) ; 円周率

(define (square x) (* x x))

;; ========== ここから上を書き換えてはいけません ==========

(define area (???))

(define (rectangle-area w h)
  (???))

(define (circle-area r)
  (???))

;; ========== ここから下を書き換えてはいけません ==========

(define (test)
  (check-equal? area 12288)
  (check-equal? (rectangle-area 10 30) 300)
  (check-equal? (rectangle-area width height) 12288)
  (check-equal? (circle-area 10) 314.0))
</code></pre></div><p>課題用ソースファイルは大きく3つのパートに分けられています．</p><ol><li><p><strong>追加説明および補助定義</strong>（ファイル先頭から「ここから上を書き換えてはいけません」までの部分）</p><p>テキストの問題文に対し追加の説明がある場合，ここにコメントで書かれています．Scheme では，「<code>;</code>（セミコロン）」からその行の末尾までがコメントとして扱われます．</p><p>また，解答コードを記述するにあたって必要となる変数や手続きの定義もここに書かれています．ほとんどは，テキスト中に出てくるコードをそのまま写したものです．<strong>これらは絶対に書き換えてはいけません．</strong></p></li><li><p><strong>編集可能領域</strong>（「ここから上を書き換えてはいけません」から「ここから下を書き換えてはいけません」までの部分）</p><p>テキストの問題文やパート 1 に書かれた追加説明に従って，ここに解答コードを記述してください．</p><p>また，課題によっては追加説明中に，</p><pre><code>(???) を書き換えることで完成させること．
それ以外のところを書き換えてはいけません．</code></pre><p>のように書かれていることがあります（上の課題1.0もそうです）．その場合，編集可能領域には，未完成の部分に <code>(???)</code> を埋め込んだ状態で解答コードの雛形が既に書かれていますので，<strong><code>(???)</code> 以外の箇所を書き換えないようにして</strong>コードを完成させてください．</p></li><li><p><strong>テスト実行用定義</strong>（「ここから下を書き換えてはいけません」からファイル末尾までの部分）</p><p>このパートには，パート 2 に書かれた解答コードが正しいかどうかを確認するための簡単なテスト用手続きが定義されています．<strong>これらも絶対に書き換えてはいけません．</strong></p><p>ほとんどのテストは <code>test</code> という名前の無引数の手続きとして定義されています<label for="side5020" class="margin-toggle sidenote-number"></label><input type="checkbox" id="side5020" class="margin-toggle"/><span class="sidenote">一部，異なる名前のこともありますが，ソースファイルを見れば分かることなので，自分で適宜確認・実行してください．</span>．提出前に，</p><pre><code>&gt; (test)</code></pre><p>と実行して，解答コードの動作を確認してください．テストを通れば何も表示されません．もし解答におかしなところがあれば，FAILURE（失敗）が発生します（発生した場合にどうなるかはこの後の例で示します）．</p></li></ol><p>なお，パート 3 のテストコード中では，Racket のユニットテスト用ライブラリ <code>rackunit</code> の <code>check-equal?</code> 手続きを使用しています．ライブラリを使用するためにパート 1 の先頭で，</p><div class="highlight"><pre><code>(require rackunit)</code></pre></div><p>とライブラリを読み込んでいます<label for="side5021" class="margin-toggle sidenote-number"></label><input type="checkbox" id="side5021" class="margin-toggle"/><span class="sidenote">C言語の <code>#include</code> 指示子と同じようなものです．</span>．その下でさらに <code>"../misc.rkt"</code> を読み込んでいますが，このファイルには演習に必要ないくつかの補助的な定義が含まれています．</p><p>手続き <code>check-equal?</code> は，</p><div class="highlight"><pre><code>(check-equal? &lt;e1&gt; &lt;e2&gt;)</code></pre></div><p>と呼び出すと，式 <code>&lt;e1&gt;</code> を評価した結果の値と式 <code>&lt;e2&gt;</code> を評価した結果の値が等しいかどうかを確認し，等しければ何もせず，等しくなければ FAILURE を発生させます．通常は，<code>&lt;e1&gt;</code> の方にテストしたい式（テストしたい手続きを適当な値の引数で呼び出す式など）を書き，<code>&lt;e2&gt;</code> には <code>&lt;e1&gt;</code> の式の値として望ましい値（期待値）を書くことで，<code>&lt;e1&gt;</code> の実行結果の正しさを確認します．</p><p>それでは，あえて間違った解答コードを書いてみましょう．</p><div class="filename" decode="exclude">ex01-1-wrong.rkt</div><div class="highlight"><pre><code>#lang racket
(require rackunit)
(require "../misc.rkt")

;;;; 課題1.1（この課題は，本演習における課題の解き方を説明するための例題です．）

;; (1) width と height の値を掛けた結果を含む変数 area を定義しなさい．
;;
;; (2) 長方形の幅と高さを引数に受け取って，その面積を返す手続き
;;    rectangle-area を定義しなさい．
;;
;; (3) 半径 r を引数に受け取って円の面積を求める手続き circle-area
;;    を定義しなさい．ただし，円周率はこのファイルで定義されている
;;    変数 pi の値としなさい．また，二乗を計算するには，同じくこの
;;    ファイルで定義されている手続き square を用いること．

;; いずれも，下の (???) を書き換えることで完成させること．
;; それ以外のところを書き換えてはいけません．

(define width 128) ; 幅
(define height 96) ; 高さ

(define pi 3.14) ; 円周率

(define (square x) (* x x))

;; ========== ここから上を書き換えてはいけません ==========

(define area (* width height))

(define (rectangle-area w h)
  (+ w h))

(define (circle-area r)
  (* pi (square r)))

;; ========== ここから下を書き換えてはいけません ==========

(define (test)
  (check-equal? area 12288)
  (check-equal? (rectangle-area 10 30) 300)
  (check-equal? (rectangle-area width height) 12288)
  (check-equal? (circle-area 10) 314.0))
</code></pre></div><p>C-x C-s で編集内容を保存したら，C-c C-k で Racket に読み込み，対話環境で <code>test</code> を呼び出してみましょう．</p><pre><code>ex01-1-wrong.rkt&gt; (test)
--------------------
; FAILURE
; /Users/umatani/le/pbe/web-src/src/ex/ex01/ex01-1-wrong.rkt:41:2
name:       check-equal?
location:   ex01-1-wrong.rkt:41:2
actual:     40
expected:   300
--------------------
--------------------
; FAILURE
; /Users/umatani/le/pbe/web-src/src/ex/ex01/ex01-1-wrong.rkt:42:2
name:       check-equal?
location:   ex01-1-wrong.rkt:42:2
actual:     224
expected:   12288
--------------------
ex01-1-wrong.rkt&gt;</code></pre><p>のように二つの FAILURE が報告されました．一つ目の FAILURE には，</p><ul><li><code>check-equal?</code>という名前のチェック</li><li>チェックしている場所は <code>ex01-1-wrong.rkt</code> の41行目(の2文字目)</li><li>式 <code>&lt;e1&gt;</code> を評価した実際の値は 40</li><li>期待値（式 <code>&lt;e2&gt;</code> の値）は 300</li></ul><p>という情報が含まれています．同じように二つ目の FAILURE も読むと，結局 41–42 行目の</p><div class="highlight"><pre><code>(check-equal? (rectangle-area 10 30) 300)
(check-equal? (rectangle-area width height) 12288)</code></pre></div><p>のチェックに引っかかっていることから，手続き <code>rectangle-area</code> の定義がおかしいことに気づきます．逆に，40行目と43行目の</p><div class="highlight"><pre><code>(check-equal? area 12288)
...
(check-equal? (circle-area 10) 314.0)</code></pre></div><p>のチェックに対しては何も表示されていないことから，これら二つのテストは無事に通過していることも分かります．</p><p>32行目の <code>(+ w h)</code> が明らかに変ですので修正しましょう．FAILURE は一つも表示されなくなるはずです．</p><p>テスト実行が済んだら，課題ソースファイルをまとめて提出しましょう．</p><p>まず，どの課題を解いたのかが分かるように，課題ソースファイルと同じディレクトリに含まれている <code>README.md</code> に，自分の解いたファイルの一覧を記入してください．ファイル中には既に，</p><pre><code># 解いた課題のリスト

下の課題一覧から，解いた課題**以外**の行を消し，
自分で解いた課題だけを残してください．

* 課題1.1（ex01-1.rkt）
* 課題1.2（ex01-2.rkt）
* 課題1.3（ex01-3.rkt）
* 課題1.4（ex01-4.rkt）</code></pre><p>のように書かれていますので，<strong>解いた課題の行だけ残し，解けていない課題の行を削除</strong>すれば OK です．</p><p><code>README.md</code> の修正が終わったら，以下のようにシェルで実行して <code>ex01</code> ディレクトリ全体（<code>ex</code> ディレクトリ全体ではないので注意）を zip ファイルにして下さい．</p><pre><code class="shell">$ cd ..
$ pwd
/Users/umatani/lecture/2022/pbe/ex
$ ls
ex01 misc.rkt
$ zip -r ex01.zip ex01</code></pre><p>最後の <code>zip</code> コマンドによって，ディレクトリ <code>ex01</code> 全体を <code>-r</code> オプションで指定している名前のファイル <code>ex01.zip</code> に圧縮しています<label for="side5022" class="margin-toggle sidenote-number"></label><input type="checkbox" id="side5022" class="margin-toggle"/><span class="sidenote">それ以外のコマンドの意味はもう分かりますよね．もし不安なようであれば <a href="#literacy-table" class="internal">ページ末尾の一覧</a>で確認しましょう．</span>．</p><p>なお，解けていない課題ソースファイルを <code>rm</code> コマンド等でいちいち削除する必要はありません．配布ファイルをダウンロードした時のまま，それらも含めて<code>zip</code> コマンドでまとめてください．逆に，ソースファイルが含まれていても <strong><tt>README.md</tt> の一覧に含まれていない限り採点しません</strong>ので，くれぐれも注意してください．</p><p>以上で完了です．出来上がった <code>ex01.zip</code> を WebClass の課題提出場所に提出しましょう．<strong>今回は課題提出方法のデモなので実際に提出する必要はありません．次回（<code>ex02</code>）から手順に従って提出してください．</strong></p><p><anchor id="submit"></anchor></p><h3>課題取り組み方まとめ</h3><ol><li><p><strong>ソースファイルの編集</strong></p><p>配布ファイル中の課題ソースファイルを使って課題を解く（解答コードを編集可能領域に記述する）．</p></li><li><p><strong>テスト実行</strong></p><p>ソースファイル中にテスト用の手続きが定義されている場合には，それを呼び出して正常に終了することを確認する．</p></li><li><p><strong>解いた問題リストの修正</strong></p><p>自分の<strong>解いた課題だけ</strong>を残すように <coe>README.md</coe> を編集する．</p></li><li><p><strong>提出用 zip ファイルの作成</strong></p><p>各回のディレクトリ（今回であれば <code>ex01</code> ディレクトリ）を zip ファイルに圧縮する．解けていない課題のファイルを削除する必要はありません．そのまま残しておいてください．</p></li><li><p><strong>WebClass に提出</strong></p><p>4 で作成した zip ファイルを，提出期限までに WebClass の課題提出場所へ提出する．</p></li></ol></section><p><anchor id="literacy-table"></anchor></p><section><h2>リテラシ関連項目まとめ</h2><h3>Emacs</h3><table><tr><th>キー</th><th>意味</th></tr><tr><td><code>C-f</code></td><td>カーソルを右（forward）へ1文字分だけ移動</td></tr><tr><td><code>C-b</code></td><td>カーソルを左（backward）へ1文字分だけ移動</td></tr><tr><td><code>C-n</code></td><td>カーソルを下（next）へ1行分だけ移動</td></tr><tr><td><code>C-p</code></td><td>カーソルを上（previous）へ1行分だけ移動</td></tr><tr><td><code>C-d</code></td><td>カーソル上の1文字を削除</td></tr><tr><td><code>C-h</code></td><td>カーソル直前の1文字を削除</td></tr><tr><td><code>C-x C-f</code></td><td>ファイルを開く</td></tr><tr><td><code>C-x C-s</code></td><td>ファイルの保存</td></tr><tr><td><code>C-x C-c</code></td><td>Emacs を終了</td></tr><tr><td><code>C-x k</code></td><td>バッファを閉じる</td></tr><tr><td><code>C-g</code></td><td>コマンドの中断</td></tr></table><h3>Racketモード</h3><table><tr><th>キー</th><th>意味</th></tr><tr><td><code>C-c C-k</code></td><td>ソースファイルを対話環境に読み込む</td></tr><tr><td><code>C-c C-z</code></td><td>ソースファイルと対話環境の間のカーソル移動</td></tr></table><h3>シェル</h3><table><tr><th width="180px">コマンド</th><th>意味</th></tr><tr><td><code>pwd</code></td><td>カレントディレクトリを表示（present working directory）</td></tr><tr><td><code>cd </code><i>dir</i></td><td>カレントディレクトリを <i>dir</i> へ変更．<i>dir</i> を指定しない場合はホームディレクトリへ変更（change directory）</td></tr><tr><td><code>ls </code><i>dir</i></td><td>ディレクトリ <i>dir</i> の中身（<i>dir</i> を省略した場合はカレントディレクトリの中身）をリスト表示（list）</td></tr><tr><td><code>cat </code><i>file</i></td><td>ファイル <i>file</i> の中身を表示</td></tr><tr><td><code>cp </code><i>src</i><code> </code><i>dst</i></td><td>ファイル <i>src</i> を <i>dst</i> へコピー（copy）</td></tr><tr><td><code>mv </code><i>src</i><code> </code><i>dst</i></td><td>ファイル <i>src</i> を <i>dst</i> へ移動（move）</td></tr><tr><td><code>rm </code><i>file</i> ...</td><td><i>file</i> ... を削除（remove）</td></tr><tr><td><code>echo </code><i>msg</i></td><td>文字列 <i>msg</i> を標準出力に表示</td></tr><tr><td><code>mkdir </code><i>dir</i></td><td>ディレクトリ <i>dir</i> を作成（make directory）</td></tr><tr><td><code>unzip </code><i>file</i></td><td>zip ファイル <i>file</i> をカレントディレクトリに展開</td></tr><tr><td><code>zip -r </code><i>file</i><code> </code><i>dir</i></td><td>ディレクトリ <i>dir</i> を zip ファイル <i>file</i> に圧縮</td></tr></table></section>
    </article>
    <nav class="bottom">
      <ul>
        <li>&nbsp;</li>
        <li>

        <span><a class="ghost">&larr; Previous</a></span>
        </li>
        <li><a href="../index.html"><i class="fas fa-home"></i> Home</a></li>
        <li><a href="../chap/02_basic.html">Next &rarr;</i></a></li>
        <li class="right copy">&copy; 2022 Seiji Umatani</li>
      </ul>
    </nav>
  </body>
</html>